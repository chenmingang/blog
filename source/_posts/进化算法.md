---
title: 进化算法
date: 2016-11-30 19:31:26
tags:
---

```python
import random
import math
import pylab
import matplotlib.animation as animation

sunCoordX = random.randint(1,99)
sunCoordY = random.randint(1,99)
lifes = []
class Life(object):
 """docstring for Life"""
 def __init__(self, name):
  #super(Life, self).__init__()
  self.name = name
  self.x = random.randint(1,99)
  self.y = random.randint(1,99)
  self.hp = random.randint(0,99)
  self.agility = random.randint(1,5)
  self.cos = self.cosWithSun()
 def live(self):
  self.move()
  self.costHp()
  self.photosynthesis()
  self.birth()
  
 def move(self):
  self.x += round(random.randint(-self.agility,self.agility))
  self.y += round(random.randint(-self.agility,self.agility))
  if(self.x<=0):
   self.x = 1
  if(self.y<=0):
   self.y = 1
  self.cos = self.cosWithSun()
  if(self.cos<5 and self.agility<10):
   self.agility +=1
   

 def printMe(self):
  if(self.hp>0):
   print "%s" % (self.name)
   print "[cos:%f,x:%d,y:%d,hp:%d,agility:%d]" % (self.cos,self.x,self.y,self.hp,self.agility)
 def photosynthesis(self):
  self.cos = self.cosWithSun()
  if(self.cos<15):
   #print "photosynthesis"
   self.hp +=11
   if(self.agility>1):
    self.agility -=1

 def costHp(self):
  self.hp -=10
  if(self.hp<=0):
   self.die()
 def die(self):
  print "%s die"%(self.name)
  lifes.remove(self)
 def cosWithSun(self):
  cos = math.sqrt((sunCoordX-self.x)**2+(sunCoordY-self.y)**2)
  #print "%d %d %d %d %d" % (sunCoordX,sunCoordY,self.x,self.y,cos)
  return cos
 def birth(self):
  if(random.randint(0,10)<2 and self.hp>70 and len(lifes)<2000):
   child = Life(self.name+"_child")
   child.x=self.x
   child.y=self.y
   child.hp=self.hp+1
   child.agility=self.agility
   lifes.append(child)

j=0
while(j<50):
 life = Life("life%d"%(j))
 lifes.append(life)
 j+=1

fig = pylab.figure()  
scat1 = pylab.scatter(1, 1, s=10,color='blue')  
scat2 = pylab.scatter(1, 1, s=50,color='red')  
pylab.xticks([0, 25, 50, 75, 100])
pylab.yticks([0, 25, 50, 75, 100])
def setup_plot():  
 return scat1,scat2

def update_plot(i):
 print "lives num %d"%len(lifes)
 data = []
 for l in lifes:
  #l.printMe()
  data.append(l.x)
  data.append(l.y)
  l.live()
 scat1.set_offsets([data])
 scat2.set_offsets([sunCoordX,sunCoordY])
 return scat1, scat2

ani = animation.FuncAnimation(fig, update_plot, interval=50, init_func=setup_plot, blit=True)
pylab.show()  
```
